#
# Fail2ban Configuration for Proxmox
# Generated by Proxmox Hardening Script
# Date: Sat Dec 13 05:44:37 AM CET 2025
#

[DEFAULT]
# Ban settings
bantime  = 3600         # Ban for 1 hour
findtime = 600          # Within 10 minutes
maxretry = 3            # After 3 failed attempts

# Ignore trusted IPs (never ban these)
ignoreip = 127.0.0.1/8 ::1 192.168.99.6

# Ban action (use iptables)
banaction = iptables-multiport
banaction_allports = iptables-allports

# Email settings (disabled - using ntfy.sh instead)
destemail = root@localhost
sender = fail2ban@proxmox
mta = sendmail

# Action when ban occurs
# For now just ban, later we'll add ntfy notifications
action = %(action_)s

# ============================================
# SSH Protection (Port 22022)
# ============================================
[sshd]
enabled  = true
port     = 22022
filter   = sshd
logpath  = /var/log/auth.log
maxretry = 3
bantime  = 7200         # Ban for 2 hours for SSH
findtime = 600

# ============================================
# Proxmox Web UI Protection (Port 8006)
# ============================================
[proxmox]
enabled  = true
port     = https,http,8006
filter   = proxmox
logpath  = /var/log/daemon.log
maxretry = 3
bantime  = 3600         # Ban for 1 hour
findtime = 600

# ============================================
# Additional Protection (Optional)
# ============================================

# Aggressive SSH protection (optional)
[sshd-aggressive]
enabled  = false
port     = 22022
filter   = sshd
logpath  = /var/log/auth.log
maxretry = 2
bantime  = 86400        # Ban for 24 hours
findtime = 300

